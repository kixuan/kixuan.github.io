<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>浅析 JWT | 炫仔的Blog</title><meta name="author" content="Xuan"><meta name="copyright" content="Xuan"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="对jwt总是一知半解，而且项目打算写个关于JWT登录的点，所以总结关于JWT的知识及面试考察过的点 参考资料： Cookie、Session、Token、JWT_通俗地讲就是验证当前用户的身份,证明-CSDN博客 JSON Web Token 入门教程 - 阮一峰的网络日志 https:&#x2F;&#x2F;cloud.tencent.com&#x2F;developer&#x2F;article&#x2F;2231547 JWT详细讲解(保">
<meta property="og:type" content="article">
<meta property="og:title" content="浅析 JWT">
<meta property="og:url" content="http://kixuan.github.io/posts/f568/index.html">
<meta property="og:site_name" content="炫仔的Blog">
<meta property="og:description" content="对jwt总是一知半解，而且项目打算写个关于JWT登录的点，所以总结关于JWT的知识及面试考察过的点 参考资料： Cookie、Session、Token、JWT_通俗地讲就是验证当前用户的身份,证明-CSDN博客 JSON Web Token 入门教程 - 阮一峰的网络日志 https:&#x2F;&#x2F;cloud.tencent.com&#x2F;developer&#x2F;article&#x2F;2231547 JWT详细讲解(保">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://kixuan.github.io/img/index_background.jpg">
<meta property="article:published_time" content="2024-03-19T16:00:00.000Z">
<meta property="article:modified_time" content="2024-09-28T04:58:27.073Z">
<meta property="article:author" content="Xuan">
<meta property="article:tag" content="JWT">
<meta property="article:tag" content="Java">
<meta property="article:tag" content="项目设计">
<meta property="article:tag" content="面试">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://kixuan.github.io/img/index_background.jpg"><link rel="shortcut icon" href="/img/avatar.png"><link rel="canonical" href="http://kixuan.github.io/posts/f568/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":"ture","top_n_per_article":2,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: {"limitDay":500,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: Xuan","link":"链接: ","source":"来源: 炫仔的Blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: ,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '浅析 JWT',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-09-28 12:58:27'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/主页背景图.jpg" data-original="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">28</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">26</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-bookmark"></i><span> 博文</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/shuoshuo"><i class="fa-fw fas fa-comments"></i><span> 聊点小天</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 听点小歌</span></a></li><li><a class="site-page child" href="/bilibili/"><i class="fa-fw fa fa-video"></i><span> 看点小番</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book"></i><span> 读点小书</span></a></li><li><a class="site-page child" href="/arttalk/"><i class="fa-fw fas fa-share-alt-square"></i><span> 人生小记</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-heart"></i><span> 个人</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li><li><a class="site-page child" href="/comment/"><i class="fa-fw fas fa-paper-plane"></i><span> 留言板</span></a></li><li><a class="site-page child" href="/aboutme/"><i class="fa-fw fas fa-user"></i><span> 关于我</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/index_background.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="炫仔的Blog"><span class="site-name">炫仔的Blog</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-bookmark"></i><span> 博文</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/shuoshuo"><i class="fa-fw fas fa-comments"></i><span> 聊点小天</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 听点小歌</span></a></li><li><a class="site-page child" href="/bilibili/"><i class="fa-fw fa fa-video"></i><span> 看点小番</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book"></i><span> 读点小书</span></a></li><li><a class="site-page child" href="/arttalk/"><i class="fa-fw fas fa-share-alt-square"></i><span> 人生小记</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-heart"></i><span> 个人</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li><li><a class="site-page child" href="/comment/"><i class="fa-fw fas fa-paper-plane"></i><span> 留言板</span></a></li><li><a class="site-page child" href="/aboutme/"><i class="fa-fw fas fa-user"></i><span> 关于我</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">浅析 JWT</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-03-19T16:00:00.000Z" title="发表于 2024-03-20 00:00:00">2024-03-20</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-09-28T04:58:27.073Z" title="更新于 2024-09-28 12:58:27">2024-09-28</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E9%A1%B9%E7%9B%AE/">项目</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">7.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>24分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="浅析 JWT"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><blockquote>
<p>对jwt总是一知半解，而且项目打算写个关于JWT登录的点，所以总结关于JWT的知识及面试考察过的点</p>
<p>参考资料：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/kagurawill/article/details/103764296?spm=1001.2101.3001.6650.2&amp;utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-2-103764296-blog-136887367.235%5Ev43%5Epc_blog_bottom_relevance_base5&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-2-103764296-blog-136887367.235%5Ev43%5Epc_blog_bottom_relevance_base5&amp;utm_relevant_index=1">Cookie、Session、Token、JWT_通俗地讲就是验证当前用户的身份,证明-CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2018/07/json_web_token-tutorial.html">JSON Web Token 入门教程 - 阮一峰的网络日志</a></p>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/2231547">https://cloud.tencent.com/developer/article/2231547</a></p>
<p><a target="_blank" rel="noopener" href="https://developer.aliyun.com/article/995894#slide-0">JWT详细讲解(保姆级教程)-阿里云开发者社区</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43973161/article/details/127012976">JWT双令牌(双token)实现登录验证_双token三验证-CSDN博客</a></p>
</blockquote>
<h1 id="零、前置知识"><a href="#零、前置知识" class="headerlink" title="零、前置知识"></a>零、前置知识</h1><p>cookie、session、token的区别</p>
<p>cookie：用于在客户端存储会话信息，并在之后每个请求中都会通过HTTP头部再将cookie发给服务器 ==》对于敏感信息不安全（跨站脚本、跨站请求伪造）</p>
<p>session：是基于 cookie 实现的，session 存储在服务器端，sessionId 会被存储到客户端的cookie 中，然后请求服务器的时候只发送Sessionid==》用户量特别大时，服务器容易分配。 </p>
<p>token：可以存储在客户端或者服务器端，具体取决于实现方式。常见的做法是将 Token 存储在客户端，比如在 localStorage、sessionStorage 或者浏览器的内存中。///无状态///可拓展性强，可以包含任何信息</p>
<h3 id="Cookie-和-Session-的区别"><a href="#Cookie-和-Session-的区别" class="headerlink" title="Cookie 和 Session 的区别"></a>Cookie 和 Session 的区别</h3><ul>
<li><strong>安全性：</strong> Session 比 Cookie 安全，Session 是存储在服务器端的，Cookie 是存储在客户端的。</li>
<li><strong>存取值的类型不同</strong>：Cookie 只支持存字符串数据，想要设置其他类型的数据，需要将其转换成字符串，Session 可以存任意数据类型。</li>
<li><strong>有效期不同：</strong> Cookie 可设置为长时间保持，比如我们经常使用的默认登录功能，Session 一般失效时间较短，客户端关闭（默认情况下）或者 Session 超时都会失效。</li>
<li><strong>存储大小不同：</strong> 单个 Cookie 保存的数据不能超过 4K，Session 可存储数据远高于 Cookie，但是当访问量过多，会占用过多的服务器资源。</li>
</ul>
<p>为什么session比cookie安全？</p>
<p>可被篡改性：Cookie 存储在客户端，可以在客户端被修改。相比之下，Session 数据通常存储在服务器端，攻击者无法直接修改。</p>
<p>可被窃取性：同上</p>
<p>持久性：这意味着即使用户关闭浏览器，这些 Cookie 也会被保存在用户的设备上。长时间的持久性可能增加了攻击者窃取 Cookie 的机会</p>
<h3 id="Token-和-Session-的区别"><a href="#Token-和-Session-的区别" class="headerlink" title="Token 和 Session 的区别"></a>Token 和 Session 的区别</h3><ul>
<li>Session 是一种记录服务器和客户端会话状态的机制，使服务端有状态化，可以记录会话信息。</li>
<li>而 Token 是访问资源接口（API）时所需要的资源凭证，使服务端无状态化，不会存储会话信息。</li>
</ul>
<h1 id="一、出现背景"><a href="#一、出现背景" class="headerlink" title="一、出现背景"></a>一、出现背景</h1><p>在传统的 Web 开发中，为了保持用户的会话状态，通常会使用基于 cookie 和 session 的方式保存相关数据，如用户角色、登陆时间。但也有一些问题，比如跨域资源共享（CORS）和无状态（Stateless）服务。</p>
<p>如果是服务器集群或者需要CORS的架构，要求session数据库共享</p>
<p>解决办法：</p>
<ol>
<li>session数据持久化——写到数据库或者别的持久层，工程量较大；稳定性不高，持久层挂了就会单点失败</li>
<li>服务器不保存session数据，数据保存在客户端，每次请求带上发回给服务器</li>
</ol>
<p><strong>JSON Web Token（缩写 JWT）是2方案的一个代表，是目前最流行的跨域认证解决方案</strong></p>
<table>
<thead>
<tr>
<th>基于session的认证流程</th>
<th>基于JWT的认证流程</th>
</tr>
</thead>
<tbody><tr>
<td>用户在浏览器中输入用户名和密码，服务器通过密码校验后生成一个session并保存到数据库服务器为用户生成一个sessionId，并将具有sesssionId的cookie放置在用户浏览器中，同时 Cookie 记录此 SessionID 属于哪个域名，在后续的该域名的请求中都将带有这个cookie信息进行访问服务器获取cookie，通过获取cookie中的sessionId查找数据库判断当前请求是否有效</td>
<td>用户在浏览器中输入用户名和密码，服务器通过密码校验后生成一个token并保存到数据库前端获取到token，存储到cookie或者local storage中，在后续的请求中都将带有这个token信息进行访问服务器获取token值，通过查找数据库判断当前token是否有效</td>
</tr>
</tbody></table>
<h1 id="二、原理"><a href="#二、原理" class="headerlink" title="二、原理"></a>二、原理</h1><h2 id="组成部分"><a href="#组成部分" class="headerlink" title="组成部分"></a>组成部分</h2><p>JWT 的原理基于三部分组成：Header、Payload 和 Signature。它们通过点（<code>.</code>）连接在一起，形成一个紧凑的字符串，可以通过 URL、POST 参数或 HTTP 头部发送。</p>
<ol>
<li>Header：包含了两部分信息：令牌的类型（即JWT），以及所使用的签名算法（例如HMAC SHA256或RSA）。</li>
<li>Payload：存放着声明（claims），即关于实体（通常是用户）和其他数据的信息。Payload包含了一些预定义的标准声明（如issuer、subject、audience等），同时也可以包含自定义的声明。</li>
<li>Signature：用于验证消息的完整性的签名部分。它由将编码的 header、payload 和一个秘密（例如，使用 HMAC 算法时的密钥）进行签名生成。</li>
</ol>
<p><img src="/img/主页背景图.jpg" data-original="https://cdn.jsdelivr.net/gh/kixuan/PicGo/asynccode" alt="img"></p>
<h2 id="运行流程"><a href="#运行流程" class="headerlink" title="运行流程"></a>运行流程</h2><ol>
<li><code>Header</code>部分是一个 JSON 对象，描述 JWT 的元数据,使用 Base64URL 算法转成字符串</li>
</ol>
<figure class="highlight json"><table><tbody><tr><td class="code"><pre><span class="line"><span class="punctuation">{</span></span><br><span class="line">    <span class="attr">"alg"</span><span class="punctuation">:</span> <span class="string">"HS256"</span><span class="punctuation">,</span>  <span class="comment">// 签名算法</span></span><br><span class="line">    <span class="attr">"typ"</span><span class="punctuation">:</span> <span class="string">"JWT"</span>     <span class="comment">// 令牌类型</span></span><br><span class="line"><span class="punctuation">}</span></span><br></pre></td></tr></tbody></table></figure>

<ol>
<li><code>Payload</code>:服务器认证以后，生成一个 JSON 对象用来存放实际需要传递的数据，再使用 Base64URL 算法转成字符串</li>
</ol>
<figure class="highlight json"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// JWT 规定了7个官方字段供选用，也可以定义私有字段</span></span><br><span class="line">- iss (issuer)：签发人</span><br><span class="line">- exp (expiration time)：过期时间</span><br><span class="line">- sub (subject)：主题</span><br><span class="line">- aud (audience)：受众</span><br><span class="line">- nbf (Not Before)：生效时间</span><br><span class="line">- iat (Issued At)：签发时间</span><br><span class="line">- jti (JWT ID)：编号</span><br><span class="line"></span><br><span class="line"><span class="punctuation">{</span></span><br><span class="line">    <span class="attr">"姓名"</span><span class="punctuation">:</span> <span class="string">"张三"</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"角色"</span><span class="punctuation">:</span> <span class="string">"管理员"</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"到期时间"</span><span class="punctuation">:</span> <span class="string">"2018年7月1日0点0分"</span></span><br><span class="line"><span class="punctuation">}</span></span><br></pre></td></tr></tbody></table></figure>

<ol>
<li><code>Signature</code>:通过将 Base64 编码后的 Header 和 Payload 与一个秘密（例如，使用 HMAC 算法时的密钥）进行签名生成的。 指定一个密钥，密钥只有服务器知道，然后使用 Header 里面指定的签名算法alg算出签名</li>
<li>客户端收到服务器返回的 JWT，可以储存在 Cookie 里面，也可以储存在 localStorage。此后，客户端每次与服务器通信，都要带上这个 JWT(也可以放在HTTP请求头信息里的<code>Authorization</code>字段,方便跨域)</li>
</ol>
<h1 id="三、代码实现"><a href="#三、代码实现" class="headerlink" title="三、代码实现"></a>三、代码实现</h1><p>参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43973161/article/details/127012976">JWT双令牌(双token)实现登录验证_双token三验证-CSDN博客</a></p>
<p>双令牌：无感登录刷新</p>
<ol>
<li>access_token  泄露概率比较大</li>
<li>refresh_token 泄露概率比较小,只有每次access_token  失效时才会使用它,所以二者组合可以很好的避免token泄露带来的安全风险,同时又能保证用户体验</li>
<li>userService的login方法<ol>
<li>保存refresh token到数据库</li>
<li>access token返回给前端</li>
</ol>
</li>
<li>刷新accessToken</li>
</ol>
<p>当短时间的token过期，前端需要通过长时间的token来访问后端，并且生成一个短时间的token返回给前端，也就是刷新短时间的token。</p>
<ol>
<li>删除refreshToken</li>
</ol>
<p>当用户退出的时候我们需要删除数据库中的refreshToken。</p>
<h1 id="四、相关面试题（来源牛客）"><a href="#四、相关面试题（来源牛客）" class="headerlink" title="四、相关面试题（来源牛客）"></a>四、相关面试题（来源牛客）</h1><h2 id="TODO-为什么token要放在redis"><a href="#TODO-为什么token要放在redis" class="headerlink" title="TODO:为什么token要放在redis"></a>TODO:为什么token要放在redis</h2><h2 id="1-jwt的token怎么生成的-x2F-jwt的参数是什么样的，有什么意义"><a href="#1-jwt的token怎么生成的-x2F-jwt的参数是什么样的，有什么意义" class="headerlink" title="1. jwt的token怎么生成的?/jwt的参数是什么样的，有什么意义"></a>1. jwt的token怎么生成的?/jwt的参数是什么样的，有什么意义</h2><p>由三个部分组成：Header、Payload 和 Signature。其中，Header 和 Payload 部分是基于 Base64 编码的 JSON 对象，而 Signature 是通过对 Header 和 Payload 进行签名生成的。</p>
<p>+运行流程</p>
<h2 id="2-jwt-是明文的吗？"><a href="#2-jwt-是明文的吗？" class="headerlink" title="2. jwt 是明文的吗？"></a>2. jwt 是明文的吗？</h2><p>Header 和 Payload 是基于 BaseURL64 编码的 JSON 对象，明文存放的</p>
<p>Signature 是加密的，但是它主要适用于验证JWT的真实性防止被篡改，不存放信息</p>
<p>所以整体来说，JWT还是明文的</p>
<h2 id="3-JWT用到了什么摘要算法"><a href="#3-JWT用到了什么摘要算法" class="headerlink" title="3. JWT用到了什么摘要算法"></a>3. JWT用到了什么摘要算法</h2><p>摘要算法：摘要算法又称哈希算法、散列算法。它通过一个函数，<strong>把任意长度的数据转换为一个长度固定的数据串</strong>（通常用16进制的字符串表示）。</p>
<p>要注意摘要算法<strong>不是加密算法</strong>，不能用于加密（因为无法通过摘要反推明文），<strong>只能用于防篡改</strong>。</p>
<p>SHA256是一种哈希算法，用于将任意长度的输入数据转换成固定长度的输出（256 位，即 32 字节）</p>
<p>工作原理：</p>
<ol>
<li>填充数据：首先SHA256 将输入数据填充至满足特定要求的长度，通常在数据末尾添加比特位，以确保数据长度满足要求。</li>
<li>分块处理：将填充后的数据按照固定长度分割成多个块，每个块的长度为 512 比特。</li>
<li>初始哈希值：设定初始的 256 比特哈希值，作为计算的起始点。</li>
<li>迭代运算：对每个块进行迭代运算，结合前一个块的哈希值，计算得到新的哈希值，直到处理完所有块。</li>
<li>输出结果：将最后一个块计算得到的哈希值作为最终的 SHA256 哈希值输出。</li>
</ol>
<p>特点：</p>
<ul>
<li><strong>固定长度输出</strong>：SHA256 输出固定长度的哈希值，即使输入数据的长度不同，输出的哈希值长度仍然相同。</li>
<li><strong>不可逆性</strong>：SHA256 是一种单向哈希函数，即无法通过哈希值反推出原始数据，保证了数据的安全性。</li>
<li><strong>抗碰撞性</strong>：SHA256 具有较高的抗碰撞性，即使对不同的输入数据计算得到相同的哈希值的可能性极低，保证了数据的唯一性和完整性。</li>
</ul>
<h2 id="4-可以使用md5摘要算法吗？"><a href="#4-可以使用md5摘要算法吗？" class="headerlink" title="4. 可以使用md5摘要算法吗？"></a>4. 可以使用md5摘要算法吗？</h2><p>MD5 摘要算法不建议用于 JWT 的签名，因为 MD5 已经被证明不安全，容易受到碰撞攻击。碰撞攻击是指攻击者能够生成两个不同的输入，但产生相同的哈希值。</p>
<p>为什么选sha256不选md5</p>
<ol>
<li>摘要长度：SHA256 生成的摘要长度（256 比特）比 MD5 长度（128 比特）更长，因此具有更大的输出空间，更难以发生碰撞（即两个不同的消息产生相同的摘要）。</li>
<li>算法结构：SHA256 是基于 Merkle–Damgard 结构的散列函数，而 MD5 是基于 MD4 结构的。SHA256 的算法结构更为复杂，使用了更多的轮次和更复杂的运算，提高了其抵抗碰撞攻击的能力。</li>
<li>算法安全性：MD5 算法在安全性上存在一些漏洞，如碰撞攻击、预图片攻击等，已经被证明不再安全。而 SHA256 目前尚未出现有效的攻击方法，因此被认为更安全。</li>
</ol>
<h2 id="5-了解RAS算法吗？"><a href="#5-了解RAS算法吗？" class="headerlink" title="5. 了解RAS算法吗？"></a>5. 了解RAS算法吗？</h2><p>rsa是一种非对称加密算法，数据可以使用公钥进行加密，然后只有持有相应私钥的一方才能解密该数据。反之，数据也可以使用私钥进行签名，然后任何持有相应公钥的一方都可以验证该签名。</p>
<p>在JWT的应用：私钥用于生成签名，而公钥用于验证签名。这样即使公钥泄露，攻击者也无法伪造有效的签名，从而确保了 JWT 的安全性。</p>
<blockquote>
<p>我趣那不是又能深入到对称加密和非对称加密</p>
<p>对称加密：相同密钥、快速高效</p>
<p>非对称加密：不同密钥、安全性较高</p>
</blockquote>
<h2 id="6-base64算法？base64的流程是什么？"><a href="#6-base64算法？base64的流程是什么？" class="headerlink" title="6. base64算法？base64的流程是什么？"></a>6. base64算法？base64的流程是什么？</h2><p>Base64 编码算法：Base64 算法将二进制数据编码成文本字符串，但并不对数据进行加密或者隐藏。它的主要目的是将二进制数据转换成纯文本格式，以便于传输或者存储。【24位转32位】</p>
<ol>
<li>把数据按照24位（3 字节）为一组进行划分</li>
<li>转成ASCII编码——转成二进制编码（24位）——每6位一组转成十进制（4个数字）——转成对应的ASCII编码——转成二进制（32位）</li>
<li>如果输入数据的长度不是 3 的整数倍，则需要添加一定数量的填充字符 “=”，使得每个 24 位的组都能够被正确地转换成四个 Base64 字符。</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_19782019/article/details/88117150">https://blog.csdn.net/qq_19782019/article/details/88117150</a></p>
<h2 id="7-双令牌认证方案是怎么实现的"><a href="#7-双令牌认证方案是怎么实现的" class="headerlink" title="7. 双令牌认证方案是怎么实现的"></a>7. 双令牌认证方案是怎么实现的</h2><p>同时使用访问令牌（Access Token）和刷新令牌（Refresh Token）来实现用户认证和无感登录刷新。这种方案可以有效地提高安全性和用户体验，具体实现方式如下：</p>
<ol>
<li>认证过程：<ol>
<li>用户使用用户名和密码等凭据进行登录，服务器验证用户身份并生成 Access Token 和 Refresh Token。</li>
<li>Access Token 用于访问受保护的资源，通常具有较短的有效期，比如几分钟到几小时。</li>
<li>Refresh Token 用于获取新的 Access Token，通常具有较长的有效期，比如几天到几个月。</li>
</ol>
</li>
<li>Access Token 过期处理：当 Access Token 过期时，用户需要使用 Refresh Token 来获取新的 Access Token，而无需重新输入用户名和密码。</li>
<li>Refresh Token 安全性：<ol>
<li>Refresh Token 通常具有较长的有效期，因此需要确保其安全性，防止被盗用。可以通过以下方式提高其安全性：<ul>
<li>将 Refresh Token 存储在安全的地方，比如 HTTP-only Cookie 或者安全存储。</li>
<li>使用 HTTPS 加密传输 Refresh Token，防止被中间人窃取。</li>
</ul>
</li>
</ol>
</li>
<li>Access Token 的定期刷新：在获取新的 Access Token 时，可以同时返回新的 Refresh Token，以确保用户持续的访问权限。</li>
</ol>
<p>通过双令牌认证方案，用户可以在不影响用户体验的情况下持续访问受保护的资源，并且可以有效地提高安全性，防止令牌被截取或滥用。</p>
<h2 id="8-为什么需要JWT？-x2F-解决了什么问题？相比之前的-cookie-session-，改用-jwt-有什么好处？"><a href="#8-为什么需要JWT？-x2F-解决了什么问题？相比之前的-cookie-session-，改用-jwt-有什么好处？" class="headerlink" title="8 .为什么需要JWT？/解决了什么问题？相比之前的 cookie + session ，改用 jwt 有什么好处？"></a>8 .为什么需要JWT？/解决了什么问题？相比之前的 cookie + session ，改用 jwt 有什么好处？</h2><p>JWT 和cookie + session功能类似，都是用于身份验证和授权</p>
<p>优点：</p>
<ol>
<li>无状态：服务器不需要再内存中保存用户的会话信息，因为JWT中已经包含了用户的所有必要信息</li>
<li>跨域支持：因为JWT是在网络请求的头部中传输的，而cookie+session跨域访问需要额外的配置和处理</li>
<li>可扩展性强：可以包含任意的Json数据，满足不同场景的需求</li>
<li>性能更好：减少服务器负载，还可以通过缓存或者CDN进行缓存，进一步提升性能</li>
<li>安全性：数字签名和加密算法</li>
</ol>
<h2 id="9-整个JWT是怎么设计的"><a href="#9-整个JWT是怎么设计的" class="headerlink" title="9. 整个JWT是怎么设计的"></a>9. 整个JWT是怎么设计的</h2><ol>
<li>令牌类型：JWT（JSON Web Token）</li>
<li>令牌内容：确定令牌中包含的信息，如用户<strong>身份信息、权限信息</strong>、过期时间等。</li>
<li>令牌签名或加密：使用后SHA256进行签名</li>
<li>令牌传输： HTTPS 加密通信</li>
<li>令牌存储：本地存储（如 Local Storage 或者 Session Storage）、HTTP Only Cookie 中</li>
<li>令牌刷新机制：双令牌认证方案</li>
<li>令牌管理：好像没有</li>
</ol>
<p>Or 见代码实现part</p>
<h2 id="10-令牌存储-x2F-为什么用redis存jwt"><a href="#10-令牌存储-x2F-为什么用redis存jwt" class="headerlink" title="10. 令牌存储/为什么用redis存jwt"></a>10. 令牌存储/为什么用redis存jwt</h2><p>本地：Local Storage</p>
<p>服务器：Redis</p>
<p>提高性能、减轻数据库负担、高可用性、分布式系统、数据持久化</p>
<h2 id="11-怎么防止别人用你的token干坏事"><a href="#11-怎么防止别人用你的token干坏事" class="headerlink" title="11. 怎么防止别人用你的token干坏事"></a>11. 怎么防止别人用你的token干坏事</h2><p>分两步：防止别人拿到token；防止别人干坏事</p>
<p> 防止别人拿到token：</p>
<ol>
<li>使用安全的<strong>传输</strong>协议：比如使用 HTTPS 协议来加密通信，防止中间人窃取 token。</li>
<li>限制 token 的<strong>使用</strong>有效期，刷新 token 机制</li>
<li>使用<strong>签名验证</strong>：在验证 token 时，确保 token 的签名是有效的，并且是由信任的签发者签发的。这可以防止伪造 token 或者篡改 token 内容。</li>
</ol>
<p> 防止别人干坏事：</p>
<ol>
<li>限制 token 的<strong>使用范围</strong>：限制 token 只能用于特定的 API 路径或者特定的操作</li>
<li><strong>定期监控</strong> token 的使用情况</li>
</ol>
<h2 id="12-使用JWT时，如果一个用户把token给了另外一个用户恶意同时登录怎么处理"><a href="#12-使用JWT时，如果一个用户把token给了另外一个用户恶意同时登录怎么处理" class="headerlink" title="12. 使用JWT时，如果一个用户把token给了另外一个用户恶意同时登录怎么处理 ?"></a>12. 使用JWT时，如果一个用户把token给了另外一个用户恶意同时登录怎么处理 ?</h2><ol>
<li>限制令牌的使用范围：可以在 JWT 中包含一些额外的声明（Claims），如用户的 IP 地址、用户角色等信息</li>
<li>实施单点登录（SSO）限制用户同时登录的设备数量</li>
<li>限制有效期</li>
<li>定期监控</li>
</ol>
<h2 id="13-对比jwt与token"><a href="#13-对比jwt与token" class="headerlink" title="13. 对比jwt与token"></a>13. 对比jwt与token</h2><ul>
<li>格式：JWT 是一种特定的令牌格式，它使用 JSON 对象作为载荷，并使用签名或加密来保证其完整性和安全性。而 Token 则是一个更广义的概念，可以是任何形式的凭证。</li>
<li>安全性：JWT 通过签名或加密来保证其安全性，而普通的 Token 可能没有这种安全保障。</li>
<li>使用场景：JWT 主要用于实现无状态的身份验证和授权，而 Token 可以用于各种场景，包括 OAuth 授权、访问令牌、刷新令牌等。</li>
</ul>
<p>总的来说，<strong>JWT 是 Token 的一种特定格式</strong>，它具有一定的安全性和标准化，适用于实现无状态的身份验证和授权。而 Token 则是一个更广义的概念，可以是各种形式的凭证，用于各种身份验证和授权场景。</p>
<h2 id="14-cookie了解吗"><a href="#14-cookie了解吗" class="headerlink" title="14. cookie了解吗"></a>14. cookie了解吗</h2><p>存储在<strong>客户端</strong>的小型文本文件，用于跟踪用户在网站上的活动，并且在用户访问同一网站时发送回服务器。</p>
<p>它们经常被用来实现用户认证、会话跟踪、个性化设置等功能。</p>
<p>由一组名称/值对组成，以及一些可选的属性。</p>
<blockquote>
<p>属性：name——表示名称</p>
<p>expires——过期时间</p>
<p>path——可以访问路径</p>
<p>domain——可访问域名</p>
<p>secure—— 只能通过 HTTPS 连接传输</p>
<p>HttpOnly——只能通过 HTTP 或 HTTPS 协议访问，而不能通过客户端脚本（如 JavaScript）访问，以防止跨站脚本（XSS）攻击。</p>
</blockquote>
<p>使用cookie需要注意安全性：跨站脚本（XSS）攻击和跨站请求伪造（CSRF）</p>
<h2 id="15-再让你优化项目还能怎么优化"><a href="#15-再让你优化项目还能怎么优化" class="headerlink" title="15. 再让你优化项目还能怎么优化"></a>15. 再让你优化项目还能怎么优化</h2><ol>
<li>减小 JWT 的大小：只包含必要的信息</li>
<li>缓存用户信息：减少每次请求都需要解析 JWT 的开销。</li>
<li>实现 Token 的刷新机制：减少用户频繁登录的次数，提高用户体验。</li>
<li>限制 Token 的访问权限：可以减少对数据库的访问次数，提高性能。</li>
<li>使用 CDN 和反向代理：可以使用 CDN（内容分发网络）和反向代理来缓存和分发 JWT Token，减轻服务器的负载，提高响应速度。</li>
</ol>
<h2 id="16-如何防止jwt传输途中被截取"><a href="#16-如何防止jwt传输途中被截取" class="headerlink" title="16. 如何防止jwt传输途中被截取"></a>16. 如何防止jwt传输途中被截取</h2><ol>
<li>使用 HTTPS 加密传输：最有效的方式是通过使用 HTTPS 协议来加密通信。HTTPS 使用了 TLS/SSL 加密技术</li>
<li>避免在 URL 中传输 JWT：不要将 JWT 直接作为 URL 参数传递，因为 URL 参数可能会被记录在日志中或者在浏览器历史记录中留下痕迹，增加了被截取的风险。而是应该将 JWT 放在 HTTP 头部的 Authorization 字段中进行传输。</li>
<li>实现 Token 的签名验证：在服务器端对接收到的 JWT 进行签名验证，确保 JWT 的完整性。</li>
<li>使用短期有效的 JWT</li>
<li>实现 Token 的刷新机制</li>
<li>额外的安全层：在 JWT 中添加额外的安全层，如 CSRF Token，防止 CSRF 攻击；或者在敏感操作中使用双因素身份验证等。</li>
</ol>
<h2 id="17-JWT缺点"><a href="#17-JWT缺点" class="headerlink" title="17. JWT缺点"></a>17. JWT缺点</h2><ol>
<li>无法撤销：一旦 JWT 被签发，除非它达到了过期时间，否则它就是有效的。</li>
<li>体积较大：JWT 包含了一些额外的信息，如标头、声明和签名等</li>
<li>无法进行会话管理：无法像传统的基于会话的身份验证那样进行会话管理，如主动注销或者强制用户重新验证。</li>
<li>安全性依赖于密钥安全性</li>
<li>不适用于敏感信息存储</li>
</ol>
<h2 id="18-JWT能够保证安全性吗？"><a href="#18-JWT能够保证安全性吗？" class="headerlink" title="18. JWT能够保证安全性吗？"></a>18. JWT能够保证安全性吗？</h2><p>Or 保证token存储在本地安全？</p>
<p>JWT 本身并不能完全保证安全性，它只是一种规范和标准，用于生成和传递令牌。安全性取决于如何使用 JWT 以及其他安全措施的配合。如：</p>
<ol>
<li>使用安全的存储机制：选择适合的存储机制来存储 Token，如浏览器的本地存储（如 Local Storage 或者 Session Storage）、HTTP Only Cookie 等</li>
<li>服务端管理好密钥</li>
<li>定期更新令牌</li>
<li>限制令牌访问范围</li>
<li>HTTPS加密传输</li>
<li>避免在url中传递敏感信息</li>
<li>避免XSS（跨站脚本）攻击</li>
</ol>
<h2 id="19-如何保证token过期刷新"><a href="#19-如何保证token过期刷新" class="headerlink" title="19. 如何保证token过期刷新"></a>19. 如何保证token过期刷新</h2><p>使用刷新令牌：除了访问令牌（Access Token）外，还可以为用户颁发一个刷新令牌（Refresh Token）</p>
<p>在访问令牌过期之前，每次访问可以通过向服务器发送特定的请求来刷新令牌</p>
<h2 id="20-无状态登录和有状态登录的区别"><a href="#20-无状态登录和有状态登录的区别" class="headerlink" title="20. 无状态登录和有状态登录的区别"></a>20. 无状态登录和有状态登录的区别</h2><ol>
<li>无状态登录（Stateless Login）：<ol>
<li>在无状态登录中，服务器不需要保存用户的会话状态。客户端在之后的每次请求中都会将该 JWT 作为身份凭证发送给服务器，服务器只需要验证 JWT 的有效性，而不需要在服务器端保存任何会话信息。</li>
<li>由于服务器不保存会话状态，因此无状态登录适用于分布式和跨域应用环境，具有更好的可扩展性和性能。</li>
</ol>
</li>
<li>有状态登录（Stateful Login）：<ol>
<li>在有状态登录中，服务器需要在服务器端保存用户的会话状态。每次用户进行身份验证时，服务器会将用户的会话信息保存在服务器端，并返回一个会话标识符（Session ID）给客户端。</li>
<li>客户端在之后的每次请求中都会将会话标识符发送给服务器，服务器通过会话标识符来识别用户的会话状态，从而进行身份验证和授权。</li>
</ol>
</li>
</ol>
<h2 id="21-退出登录、注册怎么通过JWT实现？"><a href="#21-退出登录、注册怎么通过JWT实现？" class="headerlink" title="21. 退出登录、注册怎么通过JWT实现？"></a>21. 退出登录、注册怎么通过JWT实现？</h2><ol>
<li>退出登录：退出登录通常意味着销毁客户端保存的 JWT 令牌。<ol>
<li>客户端发送一个特殊的请求，如注销请求，到服务器端。</li>
<li>服务器端收到注销请求后，将相应用户的 JWT 令牌加入一个黑名单列表或者删除相应的令牌信息。</li>
<li>客户端收到服务器的响应后，删除本地存储的 JWT 令牌，使用户被注销。</li>
</ol>
</li>
<li>注册：<ol>
<li>客户端向服务器发送注册请求，包含新用户的注册信息，如用户名和密码等。</li>
<li>服务器接收到注册请求后，验证注册信息的合法性，并创建新用户。随后，服务器生成相应用户的 JWT 令牌，并将其返回给客户端。</li>
<li>客户端收到服务器返回的 JWT 令牌后，将其保存在本地，以便在以后的请求中使用。</li>
</ol>
</li>
</ol>
<h2 id="22-如果用户更改了密码，如何处理jwt令牌"><a href="#22-如果用户更改了密码，如何处理jwt令牌" class="headerlink" title="22. 如果用户更改了密码，如何处理jwt令牌"></a>22. 如果用户更改了密码，如何处理jwt令牌</h2><p>让令牌失效：</p>
<ol>
<li>强制用户重新登录：当用户更改密码后，服务器端直接删除用户之前的所有 JWT 令牌，并要求用户重新登录。</li>
<li>使用密码加盐：在用户更改密码时，修改用户的密码同时也修改密码的盐值。</li>
<li>添加版本号或时间戳：在 JWT 的负载中添加一个版本号或者时间戳字段，表示用户的密码版本或者密码修改时间。</li>
</ol>
<h2 id="23-怎么让JWT提前失效"><a href="#23-怎么让JWT提前失效" class="headerlink" title="23. 怎么让JWT提前失效"></a>23. 怎么让JWT提前失效</h2><ol>
<li>设置过期时间（exp）：JWT 的playLoad中包含了一个名为 “exp” 的声明，可以设置</li>
<li>撤销令牌：维护一个令牌撤销列表，当用户注销或者改变了密码时，将相应的令牌加入到撤销列表中，以使这些令牌失效。</li>
<li>使用刷新令牌：刷新令牌有更长的有效期，可以获取访问令牌。一旦刷新令牌失效或者被使用，之前颁发的访问令牌就会提前失效。</li>
</ol>
<h2 id="24-强行让JWT失效会发生什么事情？"><a href="#24-强行让JWT失效会发生什么事情？" class="headerlink" title="24. 强行让JWT失效会发生什么事情？"></a>24. 强行让JWT失效会发生什么事情？</h2><p>JWT通常被设计为服务器不需要在数据库中存储任何关于令牌的信息</p>
<p>然而，如果强行让 JWT 失效，通常需要在服务器端维护一个令牌的黑名单或者撤销列表，这就涉及到在数据库或者其他持久化存储中存储令牌信息，违背了 JWT 无状态的初衷。</p>
<h2 id="25-除了JWT还有没有别的方案，它们之间的优缺点分别是什么"><a href="#25-除了JWT还有没有别的方案，它们之间的优缺点分别是什么" class="headerlink" title="25. 除了JWT还有没有别的方案，它们之间的优缺点分别是什么"></a>25. 除了JWT还有没有别的方案，它们之间的优缺点分别是什么</h2><ol>
<li>Cookie + session</li>
<li>OAuth：通常用于实现第三方登录</li>
<li>JWT：实现无状态的用户身份验证和授权，适用于需要在不同的应用之间传递用户身份信息的情况，如单点登录、跨域认证等。</li>
</ol>
<h2 id="26-介绍一下单点登录，jwt怎么实现单点登录？"><a href="#26-介绍一下单点登录，jwt怎么实现单点登录？" class="headerlink" title="26. 介绍一下单点登录，jwt怎么实现单点登录？"></a>26. 介绍一下单点登录，jwt怎么实现单点登录？</h2><p>单点登录（Single Sign-On，简称 SSO）是一种身份认证的机制，允许用户通过一次登录，就能够访问多个相关的系统或服务。</p>
<p> 在一个认证中心进行登录，获取JWT，然后访问其他服务都将这个JWT作为身份凭证发送给服务端</p>
<p> 而且JWT可以实现自定义声明，适用于单点登录</p>
<h2 id="27-跨域是什么，为什么会有跨域问题？"><a href="#27-跨域是什么，为什么会有跨域问题？" class="headerlink" title="27. 跨域是什么，为什么会有跨域问题？"></a>27. 跨域是什么，为什么会有跨域问题？</h2><p>跨域（Cross-Origin）是指在 Web 开发中，当一个域名下的文档或脚本试图去请求另一个域名下的资源时，就会产生跨域问题。</p>
<p>跨域流程：</p>
<ol>
<li>用户登录：用户在任意一个服务器上进行登录，登录成功后，服务器生成 JWT 并将其返回给客户端。</li>
<li>JWT 传递：客户端收到 JWT 后，将其保存在本地，通常是在浏览器的本地存储（如 Local Storage）或者 Cookie 中。</li>
<li>跨域请求：用户在其他服务器上进行访问时，客户端将 JWT 放入请求头中（通常是 Authorization 头），发送到另一个服务器。</li>
<li>JWT 验证：另一个服务器接收到请求后，验证 JWT 的签名和有效期。如果验证通过，则说明用户已经通过认证，可以继续处理请求；否则，返回相应的错误信息。</li>
<li>响应处理：另一个服务器处理完请求后，可以生成新的 JWT 并返回给客户端，以便客户端在下次请求时继续使用。</li>
</ol>
<p>跨域问题产生的原因主要有以下几点：</p>
<ol>
<li>同源策略（Same-Origin Policy）：同源策略是浏览器的一项安全策略，限制了一个域下的文档或脚本与另一个域下的资源进行交互。同源策略规定了只有当请求的协议、主机和端口号完全一致时，才允许进行跨域请求，否则就会产生跨域问题。</li>
<li>安全性考虑：跨域请求可能会带来安全隐患，比如跨站脚本（XSS）攻击和跨站请求伪造（CSRF）攻击等。浏览器为了保护用户的信息安全，因此默认情况下会阻止跨域请求。</li>
<li>浏览器限制：浏览器出于安全考虑，对跨域请求进行了限制，包括不允许跨域读取 Cookie、不允许跨域访问 DOM 和不允许跨域发送 AJAX 请求等。</li>
</ol>
<p>跨域问题会影响到 Web 开发中的很多场景，比如跨域 AJAX 请求、跨域资源共享（CORS）、跨文档消息传递（PostMessage）等。为了解决跨域问题，通常可以采取以下几种方法：</p>
<ul>
<li>CORS（Cross-Origin Resource Sharing）：通过服务端设置响应头来允许跨域请求，从而在客户端浏览器上解决跨域问题。<ul>
<li>使用 @CrossOrigin 注解</li>
<li>全局配置 CORS<code>public class CorsConfig implements WebMvcConfigurer</code></li>
<li>通过配置文件配置 CORS</li>
</ul>
</li>
<li>WebSocket：WebSocket 不受同源策略的限制，可以通过建立 WebSocket 连接来实现跨域通信。</li>
</ul>
<h2 id="28-企业有多个服务器多个域名怎么实现jwt？除了jwt还有哪些能实现跨域认证"><a href="#28-企业有多个服务器多个域名怎么实现jwt？除了jwt还有哪些能实现跨域认证" class="headerlink" title="28. 企业有多个服务器多个域名怎么实现jwt？除了jwt还有哪些能实现跨域认证"></a>28. 企业有多个服务器多个域名怎么实现jwt？除了jwt还有哪些能实现跨域认证</h2><ol>
<li>单点登录</li>
<li>JWT包含域名信息</li>
<li>使用统一的认证服务器，负责用户身份认证和生成 JWT。所有的服务器都向该认证服务器发送认证请求，验证用户身份后生成 JWT 返回给客户端。</li>
</ol>
<p>其他跨域认证方法：</p>
<p>1.OAuth2.0</p>
<h2 id="29-场景题：设计一个手机端扫码登录电脑端的的功能"><a href="#29-场景题：设计一个手机端扫码登录电脑端的的功能" class="headerlink" title="29. 场景题：设计一个手机端扫码登录电脑端的的功能"></a>29. 场景题：设计一个手机端扫码登录电脑端的的功能</h2><ol>
<li>生成登录二维码：<ol>
<li>在电脑端的登录页面上生成一个登录二维码。</li>
<li>二维码内容可以是一个唯一的标识符，代表着当前登录会话的标识。</li>
</ol>
</li>
<li>手机端扫码</li>
<li>验证二维码：<ol>
<li>手机端扫描到二维码后，将二维码的内容发送到服务器进行验证。</li>
<li>服务器验证二维码的有效性，并确定该二维码对应的登录会话是否有效。</li>
</ol>
</li>
<li>登录确认：<ol>
<li>如果二维码有效，服务器返回登录确认信息给手机端。</li>
<li>手机端接收到确认信息后，提示用户确认登录操作。</li>
</ol>
</li>
<li>登录处理：<ol>
<li>用户在手机端确认登录操作后，手机端发送登录请求给服务器，携带用户身份信息。</li>
<li>服务器验证用户身份信息，并在后台完成登录流程。</li>
</ol>
</li>
<li>登录状态同步：<ol>
<li>服务器在登录成功后，在电脑端和手机端均生成对应的登录状态信息（如登录令牌或者会话标识）。</li>
<li>电脑端和手机端均保存登录状态信息，以便在后续的操作中进行身份验证和授权。</li>
</ol>
</li>
<li>登录完成：<ol>
<li>登录完成后，电脑端和手机端均显示登录成功的提示。</li>
<li>用户可以在电脑端和手机端自由操作，并保持登录状态的同步。</li>
</ol>
</li>
</ol>
<h2 id="30-其他：websock……"><a href="#30-其他：websock……" class="headerlink" title="30. 其他：websock……"></a>30. 其他：websock……</h2><p>如何自定义登录接口以及jwt过滤器</p>
<p>websocket 轮询什么的</p>
<h2 id="扩展：集成-Sa-token-实现角色认证和权限认证，并使用Redis集成进行缓存，添加API签名参数增强"><a href="#扩展：集成-Sa-token-实现角色认证和权限认证，并使用Redis集成进行缓存，添加API签名参数增强" class="headerlink" title="扩展：集成 Sa-token 实现角色认证和权限认证，并使用Redis集成进行缓存，添加API签名参数增强"></a>扩展：集成 Sa-token 实现角色认证和权限认证，并使用Redis集成进行缓存，添加API签名参数增强</h2><p><a target="_blank" rel="noopener" href="https://sa-token.cc/doc.html#/up/integ-redis">Sa-Token</a></p>
<p>oauth2.0 vs sso，jwt 双token</p>
<p>为什么不选择SpringSecurity 、Shiro</p>
<ol>
<li>需求能否被胜任：单点登录, 身份切换, 等等等等, 以及可能产生的需求, auth2, 动态鉴权</li>
<li>上手难度小：SaToken最简单, Shiro中规中矩, SpringSecurity最繁琐</li>
<li>友好程度：文档是否友好, demo是否完善, 以及各大论坛博客文章错误内容多不多. 如果是中文的话SaToken更友好, 英文则SpringSecurity</li>
</ol>
<p>登录的逻辑，需要从请求发到服务端开始，说清楚springmvc的处理流程，然后在到业务处理，包括方法的返回值都要说清楚。</p>
<p>API签名参数</p>
<p><img src="/img/主页背景图.jpg" data-original="https://cdn.jsdelivr.net/gh/kixuan/PicGo/asynccode" alt="img"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://kixuan.github.io">Xuan</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://kixuan.github.io/posts/f568/">http://kixuan.github.io/posts/f568/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://kixuan.github.io" target="_blank">炫仔的Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/JWT/">JWT</a><a class="post-meta__tags" href="/tags/Java/">Java</a><a class="post-meta__tags" href="/tags/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1/">项目设计</a><a class="post-meta__tags" href="/tags/%E9%9D%A2%E8%AF%95/">面试</a></div><div class="post_share"><div class="social-share" data-image="/img/index_background.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/f110/" title="被讨厌的勇气"><img class="cover" src="/img/主页背景图.jpg" data-original="/img/index_background.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">被讨厌的勇气</div></div></a></div><div class="next-post pull-right"><a href="/posts/f111/" title="掌控习惯"><img class="cover" src="/img/主页背景图.jpg" data-original="/img/index_background.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">掌控习惯</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/7244/" title="MybatisPlus"><img class="cover" src="/img/主页背景图.jpg" data-original="/img/index_background.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-08</div><div class="title">MybatisPlus</div></div></a></div><div><a href="/posts/9478/" title="Maven 学习笔记"><img class="cover" src="/img/主页背景图.jpg" data-original="/img/index_background.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-08</div><div class="title">Maven 学习笔记</div></div></a></div><div><a href="/posts/bfac/" title="Spring-Day01—  IOC&amp;DI"><img class="cover" src="/img/主页背景图.jpg" data-original="/img/index_background.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-05</div><div class="title">Spring-Day01—  IOC&amp;DI</div></div></a></div><div><a href="/posts/83dd/" title="SpringBoot"><img class="cover" src="/img/主页背景图.jpg" data-original="/img/index_background.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-08</div><div class="title">SpringBoot</div></div></a></div><div><a href="/posts/c1c1/" title="Spring-Day02  —  注解开发"><img class="cover" src="/img/主页背景图.jpg" data-original="/img/index_background.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-07</div><div class="title">Spring-Day02  —  注解开发</div></div></a></div><div><a href="/posts/308c/" title="Spring-Day03  — AOP"><img class="cover" src="/img/主页背景图.jpg" data-original="/img/index_background.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-08</div><div class="title">Spring-Day03  — AOP</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%9B%B6%E3%80%81%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86"><span class="toc-number">1.</span> <span class="toc-text">零、前置知识</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Cookie-%E5%92%8C-Session-%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">1.0.1.</span> <span class="toc-text">Cookie 和 Session 的区别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Token-%E5%92%8C-Session-%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">1.0.2.</span> <span class="toc-text">Token 和 Session 的区别</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%87%BA%E7%8E%B0%E8%83%8C%E6%99%AF"><span class="toc-number">2.</span> <span class="toc-text">一、出现背景</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%8E%9F%E7%90%86"><span class="toc-number">3.</span> <span class="toc-text">二、原理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E6%88%90%E9%83%A8%E5%88%86"><span class="toc-number">3.1.</span> <span class="toc-text">组成部分</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%90%E8%A1%8C%E6%B5%81%E7%A8%8B"><span class="toc-number">3.2.</span> <span class="toc-text">运行流程</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="toc-number">4.</span> <span class="toc-text">三、代码实现</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98%EF%BC%88%E6%9D%A5%E6%BA%90%E7%89%9B%E5%AE%A2%EF%BC%89"><span class="toc-number">5.</span> <span class="toc-text">四、相关面试题（来源牛客）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#TODO-%E4%B8%BA%E4%BB%80%E4%B9%88token%E8%A6%81%E6%94%BE%E5%9C%A8redis"><span class="toc-number">5.1.</span> <span class="toc-text">TODO:为什么token要放在redis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-jwt%E7%9A%84token%E6%80%8E%E4%B9%88%E7%94%9F%E6%88%90%E7%9A%84-x2F-jwt%E7%9A%84%E5%8F%82%E6%95%B0%E6%98%AF%E4%BB%80%E4%B9%88%E6%A0%B7%E7%9A%84%EF%BC%8C%E6%9C%89%E4%BB%80%E4%B9%88%E6%84%8F%E4%B9%89"><span class="toc-number">5.2.</span> <span class="toc-text">1. jwt的token怎么生成的?&#x2F;jwt的参数是什么样的，有什么意义</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-jwt-%E6%98%AF%E6%98%8E%E6%96%87%E7%9A%84%E5%90%97%EF%BC%9F"><span class="toc-number">5.3.</span> <span class="toc-text">2. jwt 是明文的吗？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-JWT%E7%94%A8%E5%88%B0%E4%BA%86%E4%BB%80%E4%B9%88%E6%91%98%E8%A6%81%E7%AE%97%E6%B3%95"><span class="toc-number">5.4.</span> <span class="toc-text">3. JWT用到了什么摘要算法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8md5%E6%91%98%E8%A6%81%E7%AE%97%E6%B3%95%E5%90%97%EF%BC%9F"><span class="toc-number">5.5.</span> <span class="toc-text">4. 可以使用md5摘要算法吗？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E4%BA%86%E8%A7%A3RAS%E7%AE%97%E6%B3%95%E5%90%97%EF%BC%9F"><span class="toc-number">5.6.</span> <span class="toc-text">5. 了解RAS算法吗？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-base64%E7%AE%97%E6%B3%95%EF%BC%9Fbase64%E7%9A%84%E6%B5%81%E7%A8%8B%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-number">5.7.</span> <span class="toc-text">6. base64算法？base64的流程是什么？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E5%8F%8C%E4%BB%A4%E7%89%8C%E8%AE%A4%E8%AF%81%E6%96%B9%E6%A1%88%E6%98%AF%E6%80%8E%E4%B9%88%E5%AE%9E%E7%8E%B0%E7%9A%84"><span class="toc-number">5.8.</span> <span class="toc-text">7. 双令牌认证方案是怎么实现的</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81JWT%EF%BC%9F-x2F-%E8%A7%A3%E5%86%B3%E4%BA%86%E4%BB%80%E4%B9%88%E9%97%AE%E9%A2%98%EF%BC%9F%E7%9B%B8%E6%AF%94%E4%B9%8B%E5%89%8D%E7%9A%84-cookie-session-%EF%BC%8C%E6%94%B9%E7%94%A8-jwt-%E6%9C%89%E4%BB%80%E4%B9%88%E5%A5%BD%E5%A4%84%EF%BC%9F"><span class="toc-number">5.9.</span> <span class="toc-text">8 .为什么需要JWT？&#x2F;解决了什么问题？相比之前的 cookie + session ，改用 jwt 有什么好处？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-%E6%95%B4%E4%B8%AAJWT%E6%98%AF%E6%80%8E%E4%B9%88%E8%AE%BE%E8%AE%A1%E7%9A%84"><span class="toc-number">5.10.</span> <span class="toc-text">9. 整个JWT是怎么设计的</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-%E4%BB%A4%E7%89%8C%E5%AD%98%E5%82%A8-x2F-%E4%B8%BA%E4%BB%80%E4%B9%88%E7%94%A8redis%E5%AD%98jwt"><span class="toc-number">5.11.</span> <span class="toc-text">10. 令牌存储&#x2F;为什么用redis存jwt</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-%E6%80%8E%E4%B9%88%E9%98%B2%E6%AD%A2%E5%88%AB%E4%BA%BA%E7%94%A8%E4%BD%A0%E7%9A%84token%E5%B9%B2%E5%9D%8F%E4%BA%8B"><span class="toc-number">5.12.</span> <span class="toc-text">11. 怎么防止别人用你的token干坏事</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-%E4%BD%BF%E7%94%A8JWT%E6%97%B6%EF%BC%8C%E5%A6%82%E6%9E%9C%E4%B8%80%E4%B8%AA%E7%94%A8%E6%88%B7%E6%8A%8Atoken%E7%BB%99%E4%BA%86%E5%8F%A6%E5%A4%96%E4%B8%80%E4%B8%AA%E7%94%A8%E6%88%B7%E6%81%B6%E6%84%8F%E5%90%8C%E6%97%B6%E7%99%BB%E5%BD%95%E6%80%8E%E4%B9%88%E5%A4%84%E7%90%86"><span class="toc-number">5.13.</span> <span class="toc-text">12. 使用JWT时，如果一个用户把token给了另外一个用户恶意同时登录怎么处理 ?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-%E5%AF%B9%E6%AF%94jwt%E4%B8%8Etoken"><span class="toc-number">5.14.</span> <span class="toc-text">13. 对比jwt与token</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-cookie%E4%BA%86%E8%A7%A3%E5%90%97"><span class="toc-number">5.15.</span> <span class="toc-text">14. cookie了解吗</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15-%E5%86%8D%E8%AE%A9%E4%BD%A0%E4%BC%98%E5%8C%96%E9%A1%B9%E7%9B%AE%E8%BF%98%E8%83%BD%E6%80%8E%E4%B9%88%E4%BC%98%E5%8C%96"><span class="toc-number">5.16.</span> <span class="toc-text">15. 再让你优化项目还能怎么优化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16-%E5%A6%82%E4%BD%95%E9%98%B2%E6%AD%A2jwt%E4%BC%A0%E8%BE%93%E9%80%94%E4%B8%AD%E8%A2%AB%E6%88%AA%E5%8F%96"><span class="toc-number">5.17.</span> <span class="toc-text">16. 如何防止jwt传输途中被截取</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#17-JWT%E7%BC%BA%E7%82%B9"><span class="toc-number">5.18.</span> <span class="toc-text">17. JWT缺点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#18-JWT%E8%83%BD%E5%A4%9F%E4%BF%9D%E8%AF%81%E5%AE%89%E5%85%A8%E6%80%A7%E5%90%97%EF%BC%9F"><span class="toc-number">5.19.</span> <span class="toc-text">18. JWT能够保证安全性吗？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#19-%E5%A6%82%E4%BD%95%E4%BF%9D%E8%AF%81token%E8%BF%87%E6%9C%9F%E5%88%B7%E6%96%B0"><span class="toc-number">5.20.</span> <span class="toc-text">19. 如何保证token过期刷新</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#20-%E6%97%A0%E7%8A%B6%E6%80%81%E7%99%BB%E5%BD%95%E5%92%8C%E6%9C%89%E7%8A%B6%E6%80%81%E7%99%BB%E5%BD%95%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">5.21.</span> <span class="toc-text">20. 无状态登录和有状态登录的区别</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#21-%E9%80%80%E5%87%BA%E7%99%BB%E5%BD%95%E3%80%81%E6%B3%A8%E5%86%8C%E6%80%8E%E4%B9%88%E9%80%9A%E8%BF%87JWT%E5%AE%9E%E7%8E%B0%EF%BC%9F"><span class="toc-number">5.22.</span> <span class="toc-text">21. 退出登录、注册怎么通过JWT实现？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#22-%E5%A6%82%E6%9E%9C%E7%94%A8%E6%88%B7%E6%9B%B4%E6%94%B9%E4%BA%86%E5%AF%86%E7%A0%81%EF%BC%8C%E5%A6%82%E4%BD%95%E5%A4%84%E7%90%86jwt%E4%BB%A4%E7%89%8C"><span class="toc-number">5.23.</span> <span class="toc-text">22. 如果用户更改了密码，如何处理jwt令牌</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#23-%E6%80%8E%E4%B9%88%E8%AE%A9JWT%E6%8F%90%E5%89%8D%E5%A4%B1%E6%95%88"><span class="toc-number">5.24.</span> <span class="toc-text">23. 怎么让JWT提前失效</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#24-%E5%BC%BA%E8%A1%8C%E8%AE%A9JWT%E5%A4%B1%E6%95%88%E4%BC%9A%E5%8F%91%E7%94%9F%E4%BB%80%E4%B9%88%E4%BA%8B%E6%83%85%EF%BC%9F"><span class="toc-number">5.25.</span> <span class="toc-text">24. 强行让JWT失效会发生什么事情？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#25-%E9%99%A4%E4%BA%86JWT%E8%BF%98%E6%9C%89%E6%B2%A1%E6%9C%89%E5%88%AB%E7%9A%84%E6%96%B9%E6%A1%88%EF%BC%8C%E5%AE%83%E4%BB%AC%E4%B9%8B%E9%97%B4%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9%E5%88%86%E5%88%AB%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-number">5.26.</span> <span class="toc-text">25. 除了JWT还有没有别的方案，它们之间的优缺点分别是什么</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#26-%E4%BB%8B%E7%BB%8D%E4%B8%80%E4%B8%8B%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95%EF%BC%8Cjwt%E6%80%8E%E4%B9%88%E5%AE%9E%E7%8E%B0%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95%EF%BC%9F"><span class="toc-number">5.27.</span> <span class="toc-text">26. 介绍一下单点登录，jwt怎么实现单点登录？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#27-%E8%B7%A8%E5%9F%9F%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%8C%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BC%9A%E6%9C%89%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98%EF%BC%9F"><span class="toc-number">5.28.</span> <span class="toc-text">27. 跨域是什么，为什么会有跨域问题？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#28-%E4%BC%81%E4%B8%9A%E6%9C%89%E5%A4%9A%E4%B8%AA%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%A4%9A%E4%B8%AA%E5%9F%9F%E5%90%8D%E6%80%8E%E4%B9%88%E5%AE%9E%E7%8E%B0jwt%EF%BC%9F%E9%99%A4%E4%BA%86jwt%E8%BF%98%E6%9C%89%E5%93%AA%E4%BA%9B%E8%83%BD%E5%AE%9E%E7%8E%B0%E8%B7%A8%E5%9F%9F%E8%AE%A4%E8%AF%81"><span class="toc-number">5.29.</span> <span class="toc-text">28. 企业有多个服务器多个域名怎么实现jwt？除了jwt还有哪些能实现跨域认证</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#29-%E5%9C%BA%E6%99%AF%E9%A2%98%EF%BC%9A%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E6%89%8B%E6%9C%BA%E7%AB%AF%E6%89%AB%E7%A0%81%E7%99%BB%E5%BD%95%E7%94%B5%E8%84%91%E7%AB%AF%E7%9A%84%E7%9A%84%E5%8A%9F%E8%83%BD"><span class="toc-number">5.30.</span> <span class="toc-text">29. 场景题：设计一个手机端扫码登录电脑端的的功能</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#30-%E5%85%B6%E4%BB%96%EF%BC%9Awebsock%E2%80%A6%E2%80%A6"><span class="toc-number">5.31.</span> <span class="toc-text">30. 其他：websock……</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%EF%BC%9A%E9%9B%86%E6%88%90-Sa-token-%E5%AE%9E%E7%8E%B0%E8%A7%92%E8%89%B2%E8%AE%A4%E8%AF%81%E5%92%8C%E6%9D%83%E9%99%90%E8%AE%A4%E8%AF%81%EF%BC%8C%E5%B9%B6%E4%BD%BF%E7%94%A8Redis%E9%9B%86%E6%88%90%E8%BF%9B%E8%A1%8C%E7%BC%93%E5%AD%98%EF%BC%8C%E6%B7%BB%E5%8A%A0API%E7%AD%BE%E5%90%8D%E5%8F%82%E6%95%B0%E5%A2%9E%E5%BC%BA"><span class="toc-number">5.32.</span> <span class="toc-text">扩展：集成 Sa-token 实现角色认证和权限认证，并使用Redis集成进行缓存，添加API签名参数增强</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2024 By Xuan</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><a target="_blank" href="https://wap.miit.gov.cn/" >我好像没有备号o_o ....</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="true" data-text="bug--,fix++,error--,success++,happy++,sad--" data-fontsize="15px" data-random="true" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div>
        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(r){r.imageLazyLoadSetting.processImages=t;var e=r.imageLazyLoadSetting.isSPA,n=r.imageLazyLoadSetting.preloadRatio||1,c=a();function a(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(){e&&(c=a());for(var t,o=0;o<c.length;o++)0<=(t=(t=c[o]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(r.innerHeight*n||document.documentElement.clientHeight*n)&&function(){var t,e,n,a,i=c[o];e=function(){c=c.filter(function(t){return i!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(i)},(t=i).hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(n=new Image,a=t.getAttribute("data-original"),n.onload=function(){t.src=a,t.removeAttribute("data-original"),e&&e()},t.src!==a&&(n.src=a))}()}function i(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",i),r.addEventListener("resize",i),r.addEventListener("orientationchange",i)}(this);</script></body></html>